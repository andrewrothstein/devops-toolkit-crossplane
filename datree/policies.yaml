apiVersion: v1
customRules:
- identifier: AWS_RDSINSTANCE_ALLOCATEDSTORAGE
  name: Ensure `allocatedStorage` is correct
  defaultMessageOnFailure: The `spec.forProvider.allocatedStorage` value must be between `1000` and `5000`
  schema:
    if:
      properties:
        kind:
          enum:
          - RDSInstance
    then:
      properties:
        spec:
          properties:
            forProviders:
              properties:
                allocatedStorage:
                  minimum: 1000
                  maximum: 5000
              required:
              - allocatedStorage
policies:
  - name: crossplane
    isDefault: true
    rules:
      - identifier: CONTAINERS_MISSING_IMAGE_VALUE_VERSION
        messageOnFailure: Incorrect value for key `image` - specify an image version to avoid unpleasant "version surprises" in the future
